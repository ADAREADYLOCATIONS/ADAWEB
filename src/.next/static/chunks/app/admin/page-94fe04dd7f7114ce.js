(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{190:function(o,e,t){Promise.resolve().then(t.bind(t,7231))},7231:function(o,e,t){"use strict";t.r(e),t.d(e,{default:function(){return po}});var r=t(3827),n=t(4090),i=t(7907),s=t(304),a=t(3894),l=t(5211),c=t(9835),d=t(470),u=t(1682),h=t(2406),p=t(6612);var x=t(4845),f=t(6520),m=t(412),g=t(8430),v=t(4558),j=t(360),w=t(4784),Z=t(3206),y=t(8205),b=t(36),C=t(512),I=t(7147),E=t(8467),S=t(624),_=t(3738),k=t(1834),P=t(6285),z=t(1231);const O="locations";function F(o){const[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[s,a]=(0,n.useState)(null),l=(0,n.useCallback)((async()=>{try{i(!0),a(null);const{data:e,error:r}=await u.O.from("location_photos").select("*").eq("location_id",o).order("created_at",{ascending:!1});if(r)throw r;t(e||[])}catch(e){console.error("Error fetching photos:",e),a("Failed to load photos")}finally{i(!1)}}),[o]),c=(0,n.useCallback)((async e=>{try{const{url:r,storagePath:n}=await async function(o,e){try{var t;if(e.size>5242880)throw new Error("File size must be less than 5MB");if(!e.type.startsWith("image/"))throw new Error("Only image files are allowed");const r=null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();if(!r)throw new Error("Invalid file extension");const n="".concat((0,z.Z)(),".").concat(r),i="location-".concat(o,"/").concat(n),{error:s,data:a}=await u.O.storage.from(O).upload(i,e,{cacheControl:"3600",upsert:!1,contentType:e.type});if(s)throw console.error("Upload error:",s),new Error("Failed to upload file");if(!(null===a||void 0===a?void 0:a.path))throw new Error("No file path returned from upload");const{data:{publicUrl:l}}=u.O.storage.from(O).getPublicUrl(i);return{url:l,storagePath:i}}catch(s){throw console.error("Error in uploadLocationPhoto:",s),s}}(o,e),{data:i,error:a}=await u.O.from("location_photos").insert([{location_id:o,url:r,storage_path:n}]).select().single();if(a)throw a;return t((o=>[i,...o])),i}catch(s){throw console.error("Error adding photo:",s),s}}),[o]),d=(0,n.useCallback)((async o=>{try{const r=e.find((e=>e.id===o));if(!r)throw new Error("Photo not found");const{error:n}=await u.O.storage.from("locations").remove([r.storage_path]);if(n)throw n;const{error:i}=await u.O.from("location_photos").delete().eq("id",o);if(i)throw i;t((e=>e.filter((e=>e.id!==o))))}catch(s){throw console.error("Error removing photo:",s),s}}),[e]);return{photos:e,loading:r,error:s,fetchPhotos:l,addPhoto:c,removePhoto:d}}var D=t(5392),N=t(5412),R=t(102);function A(o){let{onDrop:e,uploading:t=!1,disabled:n=!1}=o;const{getRootProps:i,getInputProps:a,isDragActive:l}=(0,R.uI)({onDrop:e,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"]},maxFiles:1,disabled:n||t});return(0,r.jsxs)(s.Z,{...i(),sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,p:3,cursor:n||t?"not-allowed":"pointer"},children:[(0,r.jsx)("input",{...a()}),t?(0,r.jsx)(D.Z,{sx:{fontSize:48,color:"primary.main",animation:"pulse 2s infinite","@keyframes pulse":{"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}}}):(0,r.jsx)(N.Z,{sx:{fontSize:48,color:"text.secondary"}}),(0,r.jsx)(c.Z,{variant:"h6",align:"center",color:"text.primary",children:t?"Uploading...":l?"Drop the photo here":"Drag & drop a photo here"}),(0,r.jsx)(c.Z,{variant:"body2",align:"center",color:"text.secondary",children:"or click to select a photo (max 5MB)"})]})}function q(o){let{onFileSelect:e}=o;return(0,r.jsxs)(s.Z,{sx:{width:"100%"},children:[(0,r.jsx)(d.Z,{sx:{border:"2px dashed",borderColor:"divider",borderRadius:2,bgcolor:"background.paper",cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",bgcolor:"action.hover"}},children:(0,r.jsx)(A,{onDrop:async o=>{const t=o[0];t&&await e(t)}})}),(0,r.jsx)(c.Z,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1,textAlign:"center"},children:"Supported formats: JPEG, PNG, GIF, WebP (max 5MB)"})]})}var U=t(368),L=t(7963),M=t(6531),J=t(1121),Y=t(2495),X=t(1195),B=t(8545);function T(o){let{url:e,onView:t,onDelete:n,editable:i=!1}=o;const a=(0,U.Z)();return(0,r.jsx)(B.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},whileHover:{scale:1.02},children:(0,r.jsxs)(s.Z,{sx:{position:"relative",width:"100%",paddingTop:"75%",borderRadius:2,overflow:"hidden",bgcolor:"background.paper",boxShadow:o=>"0 4px 12px ".concat((0,Y.Fq)(o.palette.common.black,.1)),"&:hover .photo-overlay":{opacity:1}},children:[(0,r.jsx)("img",{src:e,alt:"Location",loading:"lazy",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"}}),(0,r.jsxs)(s.Z,{className:"photo-overlay",sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:(0,Y.Fq)(a.palette.common.black,.6),opacity:0,transition:"opacity 0.2s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[(0,r.jsx)(y.Z,{title:"View",children:(0,r.jsx)(Z.Z,{size:"small",onClick:o=>{o.stopPropagation(),t()},sx:{color:"white",bgcolor:(0,Y.Fq)(a.palette.common.white,.1),"&:hover":{bgcolor:(0,Y.Fq)(a.palette.common.white,.2),transform:"scale(1.1)"},transition:"all 0.2s ease-in-out"},children:(0,r.jsx)(X.Z,{})})}),i&&n&&(0,r.jsx)(y.Z,{title:"Delete",children:(0,r.jsx)(Z.Z,{size:"small",onClick:o=>{o.stopPropagation(),n()},sx:{color:"white",bgcolor:(0,Y.Fq)(a.palette.error.main,.1),"&:hover":{bgcolor:(0,Y.Fq)(a.palette.error.main,.2),transform:"scale(1.1)"},transition:"all 0.2s ease-in-out"},children:(0,r.jsx)(k.Z,{})})})]})]})})}function V(o){let{photos:e,onPhotoSelect:t,onPhotoDelete:n,editable:i=!1}=o;const s=(0,U.Z)(),a=(0,L.Z)(s.breakpoints.down("sm"));return(0,r.jsx)(M.Z,{cols:a?2:3,gap:16,sx:{m:0,width:"100%",height:"auto","& .MuiImageListItem-root":{overflow:"hidden"}},children:e.map((o=>(0,r.jsx)(J.Z,{children:(0,r.jsx)(T,{url:o.url,onView:()=>t(o.url),onDelete:i&&n?()=>n(o.id):void 0,editable:i})},o.id)))})}var W=t(9309);function G(o){let{photo:e,onClose:t}=o;return e?(0,r.jsxs)(b.Z,{open:!!e,onClose:t,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{bgcolor:"background.paper",position:"relative"}},children:[(0,r.jsx)(Z.Z,{onClick:t,sx:{position:"absolute",right:8,top:8,color:"white",bgcolor:"rgba(0, 0, 0, 0.5)",zIndex:1,"&:hover":{bgcolor:"rgba(0, 0, 0, 0.7)"}},children:(0,r.jsx)(W.Z,{})}),(0,r.jsx)(I.Z,{sx:{p:0},children:(0,r.jsx)(s.Z,{sx:{width:"100%",height:"80vh",position:"relative",overflow:"hidden"},children:(0,r.jsx)("img",{src:e,alt:"Location preview",style:{width:"100%",height:"100%",objectFit:"contain"}})})})]}):null}function Q(o){let{photos:e,onPhotoDelete:t,editable:i=!1}=o;const[a,l]=(0,n.useState)(null);return 0===e.length?(0,r.jsx)(c.Z,{color:"text.secondary",align:"center",sx:{py:4},children:"No photos available"}):(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(V,{photos:e,onPhotoSelect:o=>l(o),onPhotoDelete:t,editable:i}),(0,r.jsx)(G,{photo:a,onClose:()=>l(null)})]})}function H(o){let{locationId:e,editable:t=!0,onClose:i,onPhotoChange:u}=o;var p;const{user:x}=(0,h.useAuth)(),f="admin"===(null===x||void 0===x||null===(p=x.app_metadata)||void 0===p?void 0:p.role);t=t&&f;const{photos:m,loading:g,error:v,fetchPhotos:j,addPhoto:w,removePhoto:Z}=F(e),[y,b]=(0,n.useState)(null);(0,n.useEffect)((()=>{j()}),[j]);return g?(0,r.jsx)(s.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,r.jsx)(l.Z,{})}):(0,r.jsxs)(s.Z,{children:[v&&(0,r.jsx)(a.Z,{severity:"error",sx:{mb:2},children:v}),y&&(0,r.jsx)(a.Z,{severity:"error",sx:{mb:2},onClose:()=>b(null),children:y}),t&&(0,r.jsxs)(s.Z,{sx:{mb:3},children:[(0,r.jsx)(c.Z,{variant:"subtitle1",gutterBottom:!0,children:"Upload New Photo"}),(0,r.jsx)(q,{onFileSelect:async o=>{try{b(null),await w(o),null===u||void 0===u||u()}catch(v){const e=v instanceof Error?v.message:"Failed to upload photo";b(e),console.error("Error handling file:",v)}}})]}),(0,r.jsxs)(s.Z,{sx:{mt:3},children:[(0,r.jsx)(c.Z,{variant:"subtitle1",gutterBottom:!0,children:m.length>0?"Photos (".concat(m.length,")"):"No Photos Yet"}),(0,r.jsx)(d.Z,{elevation:0,sx:{p:2,bgcolor:"background.default",borderRadius:2},children:(0,r.jsx)(Q,{photos:m,onPhotoDelete:async o=>{try{await Z(o),null===u||void 0===u||u()}catch(v){console.error("Error deleting photo:",v);const e=v instanceof Error?v.message:"Failed to delete photo";b(e)}},editable:t})})]}),i&&(0,r.jsx)(s.Z,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:(0,r.jsx)(P.Z,{variant:"contained",onClick:i,children:"Done"})})]})}var K=t(3845),$=t(6207);function oo(o){let{locationId:e,onClick:t}=o;const{count:n,loading:i}=(0,$.F)(e);return(0,r.jsx)(y.Z,{title:"".concat(n," photos"),children:(0,r.jsxs)(s.Z,{onClick:t,sx:{display:"flex",alignItems:"center",gap:.5,cursor:t?"pointer":"default",color:"primary.main","&:hover":t?{color:"primary.dark"}:void 0},children:[(0,r.jsx)(K.Z,{fontSize:"small"}),i?(0,r.jsx)(l.Z,{size:16}):(0,r.jsx)(s.Z,{component:"span",sx:{fontSize:"0.875rem"},children:n})]})})}function eo(o){let{locations:e,onEdit:t,onApprove:i,onReject:s,onDelete:a,showApproveReject:l=!1}=o;var d;const[u,p]=(0,n.useState)(null),[P,z]=(0,n.useState)(0),{user:O}=(0,h.useAuth)(),F="admin"===(null===O||void 0===O||null===(d=O.app_metadata)||void 0===d?void 0:d.role);return(0,r.jsxs)(x.Z,{children:[(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(m.Z,{children:(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(v.Z,{children:"Name"}),(0,r.jsx)(v.Z,{children:"Address"}),(0,r.jsx)(v.Z,{children:"Accessibility"}),(0,r.jsx)(v.Z,{children:"Photos"}),(0,r.jsx)(v.Z,{children:"Submitted By"}),(0,r.jsx)(v.Z,{children:"Date"}),(0,r.jsx)(v.Z,{align:"right",children:"Actions"})]})}),(0,r.jsx)(j.Z,{children:0===e.length?(0,r.jsx)(g.Z,{children:(0,r.jsx)(v.Z,{colSpan:7,align:"center",children:(0,r.jsx)(c.Z,{color:"text.secondary",children:"No locations found"})})}):e.map((o=>{var e;return(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(v.Z,{children:o.name}),(0,r.jsx)(v.Z,{children:o.address}),(0,r.jsx)(v.Z,{children:(0,r.jsx)(w.Z,{label:(null===(e=o.accessibility_level)||void 0===e?void 0:e.toUpperCase())||"UNKNOWN",color:"high"===o.accessibility_level?"success":"medium"===o.accessibility_level?"warning":"error",size:"small"})}),(0,r.jsx)(v.Z,{children:!l&&"approved"===o.status&&o.id&&(0,r.jsx)(oo,{locationId:o.id,onClick:()=>p(o)},"".concat(o.id,"-").concat(P))}),(0,r.jsx)(v.Z,{children:o.submitted_by||"Anonymous"}),(0,r.jsx)(v.Z,{children:new Date(o.submitted_at).toLocaleDateString()}),(0,r.jsxs)(v.Z,{align:"right",children:[(0,r.jsx)(Z.Z,{onClick:()=>o.id&&t(o.id),disabled:!F,color:"primary",size:"small",sx:{mr:1},children:(0,r.jsx)(y.Z,{title:"Edit",children:(0,r.jsx)(E.Z,{fontSize:"small"})})}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Z.Z,{onClick:()=>(o=>{"pending"===o.status&&i(o)})(o),disabled:!F,color:"success",size:"small",sx:{mr:1},children:(0,r.jsx)(y.Z,{title:"Approve",children:(0,r.jsx)(S.Z,{fontSize:"small"})})}),(0,r.jsx)(Z.Z,{onClick:()=>o.id&&s(o.id),disabled:!F,color:"error",size:"small",sx:{mr:1},children:(0,r.jsx)(y.Z,{title:"Reject",children:(0,r.jsx)(_.Z,{fontSize:"small"})})})]}),(0,r.jsx)(Z.Z,{onClick:()=>a(o),disabled:!F,color:"error",size:"small",children:(0,r.jsx)(y.Z,{title:"Delete",children:(0,r.jsx)(k.Z,{fontSize:"small"})})})]})]},o.id)}))})]}),(0,r.jsxs)(b.Z,{open:!!u,onClose:()=>p(null),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[(0,r.jsxs)(C.Z,{children:["Manage Photos - ",null===u||void 0===u?void 0:u.name]}),(0,r.jsx)(I.Z,{children:u&&u.id&&(0,r.jsx)(H,{locationId:u.id,editable:!0,onClose:()=>p(null),onPhotoChange:()=>{z((o=>o+1))}})})]})]})}var to=t(8883),ro=t(4111),no=t(8562);function io(o){let{value:e,onChange:t}=o;return(0,r.jsx)(to.Z,{fullWidth:!0,placeholder:"Search by name, address, or accessibility level...",value:e,onChange:o=>t(o.target.value),InputProps:{startAdornment:(0,r.jsx)(ro.Z,{position:"start",children:(0,r.jsx)(no.Z,{color:"action"})})},sx:{mb:2}})}var so=t(9171),ao=t(6840);function lo(o){let{activeTab:e,pendingCount:t,approvedCount:n,onChange:i}=o;return(0,r.jsx)(s.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(so.Z,{value:e,onChange:(o,e)=>i(e),children:[(0,r.jsx)(ao.Z,{label:"Pending (".concat(t,")")}),(0,r.jsx)(ao.Z,{label:"Approved (".concat(n,")")})]})})}var co=t(9969);function uo(o){let{open:e,locationName:t,onClose:n,onConfirm:i}=o;return(0,r.jsxs)(b.Z,{open:e,onClose:n,PaperProps:{sx:{borderRadius:2}},children:[(0,r.jsx)(C.Z,{children:"Confirm Delete"}),(0,r.jsxs)(I.Z,{children:["Are you sure you want to delete ",t,"?"]}),(0,r.jsxs)(co.Z,{children:[(0,r.jsx)(P.Z,{onClick:n,children:"Cancel"}),(0,r.jsx)(P.Z,{onClick:i,color:"error",children:"Delete"})]})]})}function ho(){var o;const{user:e}=(0,h.useAuth)(),t=(0,i.useRouter)(),[x,f]=(0,n.useState)([]),[m,g]=(0,n.useState)([]),[v,j]=(0,n.useState)([]),[w,Z]=(0,n.useState)(!0),[y,b]=(0,n.useState)(null),[C,I]=(0,n.useState)(0),[E,S]=(0,n.useState)(""),[_,k]=(0,n.useState)(null),P="admin"===(null===e||void 0===e||null===(o=e.app_metadata)||void 0===o?void 0:o.role),z=(0,n.useCallback)((async()=>{try{Z(!0),b(null);const[o,e]=await Promise.all([u.O.from("pending_locations").select("*").order("submitted_at",{ascending:!1}),u.O.from("locations").select("\n            *,\n            location_photos (\n              id,\n              url,\n              storage_path\n            )\n          ").eq("status","approved").order("created_at",{ascending:!1})]);if(o.error)throw o.error;if(e.error)throw e.error;f(o.data||[]),g(e.data.map((o=>{var e;return{...o,photos:(null===(e=o.location_photos)||void 0===e?void 0:e.map((o=>o.url)))||[]}}))),j(0===C?o.data:e.data)}catch(o){console.error("Error fetching locations:",o),b("Failed to fetch locations")}finally{Z(!1)}}),[C]);(0,n.useEffect)((()=>{P&&z()}),[z,P]);const O=(0,n.useCallback)((o=>{S(o);const e=0===C?x:m;if(!o.trim())return void j(e);const t=o.toLowerCase(),r=e.filter((o=>{var e;return o.name.toLowerCase().includes(t)||o.address.toLowerCase().includes(t)||(null===(e=o.accessibility_level)||void 0===e?void 0:e.toLowerCase().includes(t))}));j(r)}),[C,x,m]);return P?w?(0,r.jsx)(s.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,r.jsx)(l.Z,{})}):(0,r.jsxs)(s.Z,{sx:{width:"100%",p:3},children:[(0,r.jsx)(c.Z,{variant:"h4",gutterBottom:!0,children:"Location Management"}),y&&(0,r.jsx)(a.Z,{severity:"error",sx:{mb:3},onClose:()=>b(null),children:y}),(0,r.jsxs)(d.Z,{sx:{mb:3},children:[(0,r.jsx)(lo,{activeTab:C,pendingCount:x.length,approvedCount:m.length,onChange:o=>{I(o),S(""),j(0===o?x:m)}}),(0,r.jsx)(s.Z,{sx:{p:2},children:(0,r.jsx)(io,{value:E,onChange:O})})]}),(0,r.jsx)(d.Z,{sx:{p:2},children:(0,r.jsx)(eo,{locations:v,onEdit:o=>{t.push("/admin/edit/".concat(o))},onApprove:async o=>{try{await async function(o){try{const{id:e,status:t,created_at:r,updated_at:n,...i}=o,{data:s,error:a}=await p.RU.from("locations").insert([{...i,status:"approved",moderated_at:(new Date).toISOString()}]).select().single();if(a)throw console.error("Error inserting approved location:",a),new Error("Failed to create approved location");const{error:l}=await p.RU.from("pending_locations").delete().eq("id",o.id);if(l)throw console.error("Error deleting pending location:",l),await p.RU.from("locations").delete().eq("id",s.id),new Error("Failed to remove pending location");return s}catch(y){throw console.error("Error in approveLocation:",y),y}}(o),await z()}catch(e){console.error("Error approving location:",e),b("Failed to approve location")}},onReject:async o=>{try{await async function(o,e){try{const{error:e}=await p.RU.from("pending_locations").delete().eq("id",o);if(e)throw console.error("Error rejecting location:",e),new Error("Failed to reject location");return!0}catch(y){throw console.error("Error in rejectLocation:",y),y}}(o),await z()}catch(e){console.error("Error rejecting location:",e),b("Failed to reject location")}},onDelete:k,showApproveReject:0===C})}),(0,r.jsx)(uo,{open:!!_,locationName:(null===_||void 0===_?void 0:_.name)||"",onClose:()=>k(null),onConfirm:()=>_&&(async o=>{try{const{error:e}=await u.O.from(0===C?"pending_locations":"locations").delete().eq("id",o.id);if(e)throw e;await z(),k(null)}catch(e){console.error("Error deleting location:",e),b("Failed to delete location")}})(_)})]}):(0,r.jsx)(s.Z,{sx:{p:3},children:(0,r.jsx)(a.Z,{severity:"error",children:"You do not have permission to access this page. Please contact an administrator."})})}function po(){return(0,r.jsx)(ho,{})}},2406:function(o,e,t){"use strict";t.r(e),t.d(e,{AuthProvider:function(){return l},useAuth:function(){return c}});var r=t(3827),n=t(4090),i=t(1682),s=t(4363);const a=(0,n.createContext)({user:null,loading:!0,signOut:async()=>{}});function l(o){let{children:e}=o;const[t,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,s.y_)();var o;l(null!==(o=null===e||void 0===e?void 0:e.user)&&void 0!==o?o:null)}catch(e){console.error("Error checking auth session:",e)}finally{d(!1)}})();const{data:{subscription:o}}=i.O.auth.onAuthStateChange(((o,e)=>{var t;l(null!==(t=null===e||void 0===e?void 0:e.user)&&void 0!==t?t:null),d(!1)}));return()=>{o.unsubscribe()}}),[]);return(0,r.jsx)(a.Provider,{value:{user:t,loading:c,signOut:async()=>{try{await(0,s.w7)(),l(null)}catch(o){throw console.error("Error signing out:",o),o}}},children:e})}const c=()=>{const o=(0,n.useContext)(a);if(void 0===o)throw new Error("useAuth must be used within an AuthProvider");return o}},6207:function(o,e,t){"use strict";t.d(e,{F:function(){return i}});var r=t(4090),n=t(1682);function i(o){const[e,t]=(0,r.useState)(0),[i,s]=(0,r.useState)(!0),[a,l]=(0,r.useState)(null),c=(0,r.useCallback)((async()=>{try{s(!0),l(null);const{count:e,error:r}=await n.O.from("location_photos").select("*",{count:"exact",head:!0}).eq("location_id",o);if(r)throw r;t(e||0)}catch(e){console.error("Error fetching photo count:",e),l("Failed to load photo count")}finally{s(!1)}}),[o]);return(0,r.useEffect)((()=>{c()}),[c]),{count:e,loading:i,error:a,refetch:c}}},4363:function(o,e,t){"use strict";t.d(e,{Ry:function(){return n},Yb:function(){return i},w7:function(){return s},y_:function(){return a}});var r=t(1682);async function n(o,e){try{const{data:t,error:n}=await r.O.auth.signInWithPassword({email:o,password:e});if(n)throw n;return t}catch(t){throw console.error("Error signing in:",t),t}}async function i(o,e){try{const{data:t,error:n}=await r.O.auth.signUp({email:o,password:e,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});if(n)throw n;return t}catch(t){throw console.error("Error signing up:",t),t}}async function s(){try{const{error:o}=await r.O.auth.signOut();if(o)throw o}catch(o){throw console.error("Error signing out:",o),o}}async function a(){try{const{data:{session:o},error:e}=await r.O.auth.getSession();if(e)throw e;return o}catch(o){throw console.error("Error getting session:",o),o}}},1682:function(o,e,t){"use strict";t.d(e,{O:function(){return i}});const r="https://vklckuwinkmvefztvawp.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZrbGNrdXdpbmttdmVmenR2YXdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM4NDk3NzcsImV4cCI6MjA0OTQyNTc3N30.aWC5z7r3YCUVG617ZUfZRrBgSY43jvq46H1ZE7SYcRg";const i=(0,t(9377).eI)(r,n,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}})},6612:function(o,e,t){"use strict";t.d(e,{Dx:function(){return c},Hm:function(){return a},RU:function(){return i},XY:function(){return l},z4:function(){return s}});const r="https://vklckuwinkmvefztvawp.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZrbGNrdXdpbmttdmVmenR2YXdwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczMzg0OTc3NywiZXhwIjoyMDQ5NDI1Nzc3fQ.jIoUbi5DwqIMtpCuQxybgN4SZ74MAfXi5kr7sLkxMY4";const i=(0,t(9377).eI)(r,n,{db:{schema:"public"}});async function s(){try{const{data:o,error:e}=await i.from("locations").select("\n        *,\n        location_photos (\n          id,\n          url,\n          storage_path\n        )\n      ").eq("status","approved").order("created_at",{ascending:!1});if(e)throw console.error("Error fetching locations:",e),e;return(null===o||void 0===o?void 0:o.map((o=>{var e;return{...o,photos:(null===(e=o.location_photos)||void 0===e?void 0:e.map((o=>o.url)))||[]}})))||[]}catch(o){throw console.error("Error in fetchLocations:",o),o}}async function a(o){try{var e;const{data:t,error:r}=await i.from("locations").select("\n        *,\n        location_photos (\n          id,\n          url,\n          storage_path\n        )\n      ").eq("id",o).single();if(r)throw r;if(!t)throw new Error("Location not found");return{...t,photos:(null===(e=t.location_photos)||void 0===e?void 0:e.map((o=>o.url)))||[]}}catch(t){throw console.error("Error fetching location:",t),t}}async function l(o,e){try{const{photos:t,location_photos:r,...n}=e,{error:s}=await i.from("locations").update(n).eq("id",o).eq("status","approved");if(s)throw s;return!0}catch(t){throw console.error("Error updating location:",t),t}}async function c(o){try{const{data:e,error:t}=await i.from("pending_locations").insert([{...o,status:"pending",submitted_at:(new Date).toISOString()}]).select().single();if(t)throw t;return e}catch(e){throw console.error("Error adding location:",e),e}}}},function(o){o.O(0,[304,653,682,373,323,883,769,35,720,971,69,744],(function(){return e=190,o(o.s=e);var e}));var e=o.O();_N_E=e}]);